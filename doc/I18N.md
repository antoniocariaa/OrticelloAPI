# Sistema di Internazionalizzazione (i18n) - Orticello API

## Lingue Supportate
- ðŸ‡®ðŸ‡¹ Italiano (it) - Default
- ðŸ‡¬ðŸ‡§ Inglese (en)
- ðŸ‡©ðŸ‡ª Tedesco (de)

## Come Funziona

Il sistema rileva automaticamente la lingua preferita dell'utente in questo ordine di prioritÃ :

1. **Query Parameter** - `?lang=en`
2. **Header Personalizzato** - `X-Language: de`
3. **Header Accept-Language** - Rilevamento automatico dal browser
4. **Lingua Default** - Italiano (it)

## Esempi di Utilizzo

### 1. Tramite Query Parameter
```bash
GET /api/v1/orti?lang=en
GET /api/v1/utenti?lang=de
```

### 2. Tramite Header Personalizzato
```bash
curl -H "X-Language: en" http://localhost:8080/api/v1/orti
```

### 3. Tramite Accept-Language (automatico dal browser)
```bash
curl -H "Accept-Language: de-DE,de;q=0.9,en;q=0.8" http://localhost:8080/api/v1/orti
```

### 4. Fetch API (JavaScript)
```javascript
// Con query parameter
fetch('/api/v1/orti?lang=en')

// Con header personalizzato
fetch('/api/v1/orti', {
  headers: {
    'X-Language': 'de'
  }
})

// Automatico (usa Accept-Language del browser)
fetch('/api/v1/orti')
```

### 5. Axios (JavaScript)
```javascript
// Con header personalizzato
axios.get('/api/v1/orti', {
  headers: {
    'X-Language': 'en'
  }
})

// Con query parameter
axios.get('/api/v1/orti', {
  params: {
    lang: 'de'
  }
})
```

## Esempi di Risposte

### Italiano (Default)
```json
{
  "message": "Orto non trovato"
}
```

### Inglese
```json
{
  "message": "Garden not found"
}
```

### Tedesco
```json
{
  "message": "Garten nicht gefunden"
}
```

## Struttura File di Traduzione

Le traduzioni sono organizzate in `/src/locales/`:

```
src/locales/
â”œâ”€â”€ it.json (Italiano)
â”œâ”€â”€ en.json (Inglese)
â””â”€â”€ de.json (Tedesco)
```

### Categorie di Messaggi

- `errors.*` - Messaggi di errore
- `success.*` - Messaggi di successo
- `notFound.*` - Messaggi per risorse non trovate
- `validation.*` - Messaggi di validazione
- `auth.*` - Messaggi di autenticazione

## Aggiungere Nuove Traduzioni

### 1. Nei Controller
```javascript
// Invece di:
res.status(404).json({ message: 'Orto non trovato' });

// Usa:
res.status(404).json({ message: req.t('notFound.orto') });
```

### 2. Nei File di Traduzione
Aggiungi la chiave in tutti i file lingua:

**it.json**
```json
{
  "notFound": {
    "orto": "Orto non trovato"
  }
}
```

**en.json**
```json
{
  "notFound": {
    "orto": "Garden not found"
  }
}
```

**de.json**
```json
{
  "notFound": {
    "orto": "Garten nicht gefunden"
  }
}
```

## Testing

### Test con cURL
```bash
# Italiano (default)
curl http://localhost:8080/api/v1/orti/invalid-id

# Inglese
curl http://localhost:8080/api/v1/orti/invalid-id?lang=en

# Tedesco
curl -H "X-Language: de" http://localhost:8080/api/v1/orti/invalid-id
```

## Best Practices

1. **Usa sempre chiavi di traduzione** invece di testo hardcoded
2. **Organizza le chiavi** per categoria (errors, success, etc.)
3. **Mantieni consistenza** nei nomi delle chiavi tra tutte le lingue
4. **Testa tutte le lingue** dopo aver aggiunto nuove traduzioni
5. **Documenta** nuove chiavi di traduzione aggiunte

## Note per gli Sviluppatori

- Il middleware `detectLanguage` Ã¨ applicato globalmente in `app.js`
- La funzione `req.t()` Ã¨ disponibile in tutti i controller
- Usa la notazione punto per chiavi annidate: `req.t('errors.retrieving_ortos')`
- Le traduzioni mancanti torneranno alla chiave stessa come fallback

## Roadmap

- [ ] Aggiungere traduzioni per tutti i controller
- [ ] Implementare traduzioni per messaggi di validazione Mongoose
- [ ] Aggiungere supporto per parametri dinamici nelle traduzioni
