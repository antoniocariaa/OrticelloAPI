openapi: 3.0.4
info:
  version: '1.0'
  title: "Orticello OpenAPI 3.0"
  description: API for managing book lendings.
  license:
    name: MIT
servers:
  - url: http://localhost:8080/api/
    description: Localhost
  - url: https://orticelloapi.onrender.com/api/
    description: render.com
paths:
  /v1/orti:
    get:
      summary: Get list of green gardens
      description: >-
        Retrieve a list of all green gardens (orti). 
        Returns an array of orto objects with their details.
      tags:
        - Orti
      responses:
        '200':
          description: Successfully retrieved list of orti
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Orto'
        '500':
          description: Error retrieving orti
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 'Error retrieving ortos'
                  error:
                    type: object
    
    post:
      summary: Create a new orto
      description: Create a new green garden with the provided information
      tags:
        - Orti
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Orto'
      responses:
        '201':
          description: Orto created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Orto'
        '500':
          description: Error creating orto
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 'Error creating orto'
                  error:
                    type: object
  
  /v1/orti/{id}:
    get:
      summary: Get orto by ID
      description: Retrieve a single green garden by its unique identifier
      tags:
        - Orti
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
          description: MongoDB ObjectId of the orto
      responses:
        '200':
          description: Successfully retrieved orto
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Orto'
        '404':
          description: Orto not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 'Orto not found'
        '500':
          description: Error retrieving orto
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 'Error retrieving orto'
                  error:
                    type: object
    
    put:
      summary: Update orto by ID
      description: Update an existing green garden with new information
      tags:
        - Orti
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
          description: MongoDB ObjectId of the orto
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Orto'
      responses:
        '200':
          description: Orto updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Orto'
        '404':
          description: Orto not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 'Orto not found'
        '500':
          description: Error updating orto
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 'Error updating orto'
                  error:
                    type: object
    
    delete:
      summary: Delete orto by ID
      description: Delete a green garden by its unique identifier
      tags:
        - Orti
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
          description: MongoDB ObjectId of the orto
      responses:
        '200':
          description: Orto deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 'Orto deleted successfully'
        '404':
          description: Orto not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 'Orto not found'
        '500':
          description: Error deleting orto
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 'Error deleting orto'
                  error:
                    type: object
  
  /v1/lotti:
    get:
      summary: Get list of lotti
      description: >-
        Retrieve a list of all lotti (plots). 
        Returns an array of lotto objects with their details.
      tags:
        - Lotti
      responses:
        '200':
          description: Successfully retrieved list of lotti
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Lotto'
        '500':
          description: Error retrieving lotti
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 'Error retrieving lotti'
                  error:
                    type: object
    
    post:
      summary: Create a new lotto
      description: Create a new plot with the provided information
      tags:
        - Lotti
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Lotto'
      responses:
        '201':
          description: Lotto created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Lotto'
        '500':
          description: Error creating lotto
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 'Error creating lotto'
                  error:
                    type: object
  
  /v1/lotti/{id}:
    get:
      summary: Get lotto by ID
      description: Retrieve a single plot by its unique identifier
      tags:
        - Lotti
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
          description: MongoDB ObjectId of the lotto
      responses:
        '200':
          description: Successfully retrieved lotto
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Lotto'
        '404':
          description: Lotto not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 'Lotto not found'
        '500':
          description: Error retrieving lotto
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 'Error retrieving lotto'
                  error:
                    type: object
    
    put:
      summary: Update lotto by ID
      description: Update an existing plot with new information
      tags:
        - Lotti
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
          description: MongoDB ObjectId of the lotto
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Lotto'
      responses:
        '200':
          description: Lotto updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Lotto'
        '404':
          description: Lotto not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 'Lotto not found'
        '500':
          description: Error updating lotto
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 'Error updating lotto'
                  error:
                    type: object
    
    delete:
      summary: Delete lotto by ID
      description: Delete a plot by its unique identifier
      tags:
        - Lotti
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
          description: MongoDB ObjectId of the lotto
      responses:
        '200':
          description: Lotto deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 'Lotto deleted successfully'
        '404':
          description: Lotto not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 'Lotto not found'
        '500':
          description: Error deleting lotto
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 'Error deleting lotto'
                  error:
                    type: object
  
  /v1/associazioni:
    get:
      summary: Get list of associazioni
      description: >-
        Retrieve a list of all associazioni (associations). 
        Returns an array of associazione objects with their details.
      tags:
        - Associazioni
      responses:
        '200':
          description: Successfully retrieved list of associazioni
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Associazione'
        '500':
          description: Error retrieving associazioni
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 'Errore nel recupero delle associazioni'
                  error:
                    type: string
    
    post:
      summary: Create a new associazione
      description: Create a new association with the provided information
      tags:
        - Associazioni
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Associazione'
      responses:
        '201':
          description: Associazione created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Associazione'
        '400':
          description: Invalid data or duplicate entry
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 'Dati non validi o duplicati'
                  error:
                    type: string
        '500':
          description: Error creating associazione
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Errore nella creazione dell'associazione"
                  error:
                    type: string
  
  /v1/associazioni/{id}:
    get:
      summary: Get associazione by ID
      description: Retrieve a single association by its unique identifier
      tags:
        - Associazioni
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
          description: MongoDB ObjectId of the associazione
      responses:
        '200':
          description: Successfully retrieved associazione
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Associazione'
        '404':
          description: Associazione not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 'Associazione non trovata'
        '500':
          description: Error retrieving associazione
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Errore nel recupero dell'associazione"
                  error:
                    type: string
    
    put:
      summary: Update associazione by ID
      description: Update an existing association with new information
      tags:
        - Associazioni
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
          description: MongoDB ObjectId of the associazione
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Associazione'
      responses:
        '200':
          description: Associazione updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Associazione'
        '400':
          description: Invalid update data
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 'Dati aggiornati non validi'
                  error:
                    type: string
        '404':
          description: Associazione not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 'Associazione non trovata'
        '500':
          description: Error updating associazione
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Errore nell'aggiornamento dell'associazione"
                  error:
                    type: string
    
    delete:
      summary: Delete associazione by ID
      description: Delete an association by its unique identifier
      tags:
        - Associazioni
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
          description: MongoDB ObjectId of the associazione
      responses:
        '200':
          description: Associazione deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 'Associazione eliminata con successo'
        '404':
          description: Associazione not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 'Associazione non trovata'
        '500':
          description: Error deleting associazione
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Errore durante l'eliminazione"
                  error:
                    type: string
  
  /v1/comune:
    get:
      summary: Get list of comuni
      description: >-
        Retrieve a list of all comuni (municipalities). 
        Returns an array of comune objects with their details.
      tags:
        - Comune
      responses:
        '200':
          description: Successfully retrieved list of comuni
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Comune'
        '500':
          description: Error retrieving comuni
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 'Errore nel recupero dei comuni'
                  error:
                    type: string
    
    post:
      summary: Create a new comune
      description: Create a new municipality with the provided information
      tags:
        - Comune
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Comune'
      responses:
        '201':
          description: Comune created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Comune'
        '400':
          description: Invalid data or duplicate entry
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 'Dati non validi o duplicati'
                  error:
                    type: string
        '500':
          description: Error creating comune
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 'Errore nella creazione del comune'
                  error:
                    type: string
  
  /v1/comune/{id}:
    get:
      summary: Get comune by ID
      description: Retrieve a single municipality by its unique identifier
      tags:
        - Comune
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
          description: MongoDB ObjectId of the comune
      responses:
        '200':
          description: Successfully retrieved comune
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Comune'
        '404':
          description: Comune not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 'Comune non trovato'
        '500':
          description: Error retrieving comune
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 'Errore nel recupero del comune'
                  error:
                    type: string
    
    put:
      summary: Update comune by ID
      description: Update an existing municipality with new information
      tags:
        - Comune
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
          description: MongoDB ObjectId of the comune
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Comune'
      responses:
        '200':
          description: Comune updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Comune'
        '400':
          description: Invalid update data
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 'Dati aggiornati non validi'
                  error:
                    type: string
        '404':
          description: Comune not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 'Comune non trovato'
        '500':
          description: Error updating comune
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Errore nell'aggiornamento del comune"
                  error:
                    type: string
    
    delete:
      summary: Delete comune by ID
      description: Delete a municipality by its unique identifier
      tags:
        - Comune
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
          description: MongoDB ObjectId of the comune
      responses:
        '200':
          description: Comune deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 'Comune eliminato con successo'
        '404':
          description: Comune not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 'Comune non trovato'
        '500':
          description: Error deleting comune
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Errore durante l'eliminazione"
                  error:
                    type: string


components:
  schemas:
    Orto:
      type: object
      required:
        - nome
        - indirizzo
        - coordinate
      properties:
        _id:
          type: string
          description: MongoDB ObjectId (generated automatically)
          readOnly: true
          example: '507f1f77bcf86cd799439011'
        nome:
          type: string
          description: Name of the green garden
          example: 'Orto di Via Roma'
        indirizzo:
          type: string
          description: Address of the green garden
          example: 'Via Roma 123, Trento'
        coordinate:
          type: object
          required:
            - lat
            - lng
          properties:
            lat:
              type: number
              format: double
              description: Latitude in decimal degrees
              example: 46.0664
            lng:
              type: number
              format: double
              description: Longitude in decimal degrees
              example: 11.1257
        lotti:
          type: array
          description: Array of references to Lotto documents
          items:
            type: string
            description: MongoDB ObjectId reference to Lotto
          example: ['507f1f77bcf86cd799439012', '507f1f77bcf86cd799439013']
    
    Lotto:
      type: object
      required:
        - dimensione
        - sensori
      properties:
        _id:
          type: string
          description: MongoDB ObjectId (generated automatically)
          readOnly: true
          example: '507f1f77bcf86cd799439012'
        dimensione:
          type: number
          description: Size of the plot in square meters
          example: 50
        sensori:
          type: boolean
          description: Whether the plot is equipped with sensors
          example: true
    
    Associazione:
      type: object
      required:
        - nome
        - indirizzo
        - telefono
        - email
      properties:
        _id:
          type: string
          description: MongoDB ObjectId (generated automatically)
          readOnly: true
          example: '507f1f77bcf86cd799439014'
        nome:
          type: string
          description: Name of the association
          example: 'Associazione Orti Urbani Trento'
        indirizzo:
          type: string
          description: Address of the association
          example: 'Via delle Associazioni 45, Trento'
        telefono:
          type: string
          description: Phone number (mobile format validated)
          example: '+393331234567'
        email:
          type: string
          format: email
          description: Email address (unique, validated)
          example: 'info@ortiurbanitrento.it'
        createdAt:
          type: string
          format: date-time
          description: Timestamp of creation (generated automatically)
          readOnly: true
          example: '2025-12-11T10:30:00.000Z'
        updatedAt:
          type: string
          format: date-time
          description: Timestamp of last update (generated automatically)
          readOnly: true
          example: '2025-12-11T10:30:00.000Z'
    
    Comune:
      type: object
      required:
        - nome
        - indirizzo
        - telefono
        - email
      properties:
        _id:
          type: string
          description: MongoDB ObjectId (generated automatically)
          readOnly: true
          example: '507f1f77bcf86cd799439015'
        nome:
          type: string
          description: Name of the municipality
          example: 'Comune di Trento'
        indirizzo:
          type: string
          description: Address of the municipality
          example: 'Piazza Duomo 1, Trento'
        telefono:
          type: string
          description: Phone number of the municipality
          example: '+390461884111'
        email:
          type: string
          format: email
          description: Email address (unique, validated)
          example: 'info@comune.trento.it'
        createdAt:
          type: string
          format: date-time
          description: Timestamp of creation (generated automatically)
          readOnly: true
          example: '2025-12-11T10:30:00.000Z'
        updatedAt:
          type: string
          format: date-time
          description: Timestamp of last update (generated automatically)
          readOnly: true
          example: '2025-12-11T10:30:00.000Z'